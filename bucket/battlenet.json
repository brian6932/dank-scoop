{
    "version": "1.18.10.3141",
    "description": "Blizzard's official games client.",
    "homepage": "https://battle.net/",
    "license": {
        "identifier": "Freeware",
        "url": "https://www.blizzard.com/en-us/legal/"
    },
    "url": "https://us.battle.net/download/getInstaller?os=win&installer=Battle.net-Setup.exe#/Battle.net-Setup.exe",
    "hash": "002f33fee7b8a159058368b7e93e492931c4ca72e90660bdb2691bcd62fedd3c",
    "pre_install": "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
    "installer": {
        "script": [
            "& \"$dir/Battle.net-Setup.exe\" --installpath=$dir",
            "$StartDate = Get-Date",
            "Do { $SetupProcess = Get-Process Battle.net-Setup -ErrorAction SilentlyContinue } Until ($null -ne $SetupProcess -or $StartDate.AddSeconds(10) -lt (Get-Date))",
            "if ($null -ne $SetupProcess) { Wait-Process $SetupProcess.Id }",
            "$BattlenetProcess = Get-Process Battle.net -ErrorAction SilentlyContinue",
            "if ($null -ne $BattlenetProcess) { Stop-Process $BattlenetProcess -Force -ErrorAction SilentlyContinue } else { error \"Unable to $cmd $app\" successfully; break }"
        ]
    },
    "pre_uninstall": [
        "if (!(is_admin)) { error \"$app requires admin rights to $cmd\"; break }",
        "if ($null -ne (Get-Process 'Agent', 'Battle.net' -ErrorAction SilentlyContinue)) { error 'Make sure Battle.net nor Agent.exe are running before uninstalling.'; break }"
    ],
    "post_uninstall": [
        "\"$env:ALLUSERSPROFILE/Battle.net\",",
        "\"$env:ALLUSERSPROFILE/Battle.net_components\",",
        "\"$env:ALLUSERSPROFILE/Microsoft/Windows/Start Menu/Programs/Battle.net\",",
        "'HKLM:/SOFTWARE/Microsoft/Windows/CurrentVersion/Uninstall/Battle.net',",
        "'HKLM:/SOFTWARE/WOW6432Node/Microsoft/Windows/CurrentVersion/Uninstall/Battle.net' | ForEach-Object { Remove-Item $_ -Force -Recurse -ErrorAction SilentlyContinue }"
    ],
    "checkver": {
        "url": "https://formulae.brew.sh/api/cask/battle-net.json",
        "jsonpath": "$.version"
    },
    "autoupdate": {
        "url": "https://us.battle.net/download/getInstaller?os=win&installer=Battle.net-Setup.exe#/Battle.net-Setup.exe"
    }
}
